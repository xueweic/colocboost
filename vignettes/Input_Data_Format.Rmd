---
title: "Input Data Format"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Input Data Format}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(colocboost)
```


This vignette documents the standard input data formats of `colocboost`.

## 1. Individual Level Data

For analyses using individual-level data, the basic format for single trait is as follows:

- `X` is an N * P matrix with N individuals and P variants. Including variant names as column names is highly recommended, especially when working with multiple X matrices and Y vectors.
- `Y` is a length N vector containing phenotype values for the same N individuals with X.

The input format for multiple traits is similar, but `X` matrix should be a list of matrices, each corresponding to a different trait. `Y` vector should also be a list of vectors. 
For example:

- `X = list(X1, X2, X3, X4, X5)` where each `Xi` is a matrix for trait `i` - with the dimension of Ni * Pi, where Ni and Pi do not need to be the same for different traits.
- `Y = list(Y1, Y2, Y3, Y4, Y5)` where each `Yi` is a vector for trait `i` - with Ni individuals.


`colocboost` also offers flexible input options (see detailed usage with different input formats, 
refer to [Individual Data Colocalization](https://statfungen.github.io/colocboost/articles/Individual_Level_Colocalization.html).):

- Single X matrix with N * P with Y matrix with N * L for L traits.
- Multiple X matrices and unmatched Y vectors with a mapping dictionary.


## 2. Summary Statistics

For analyses using summary statistics, the basic format for single trait is as follows:

- `sumstat` is a data frame with required columns `z` or (`beta`, `sebeta`), and optional columns but highly recommended `n` and `variant`.
```{r summary-stats-example}
data(Sumstat_5traits)
head(Sumstat_5traits$sumstat[[1]])
```

    - `z` or (`beta`, `sebeta`) - required: either z-score or (effect size and standard error)
    - `n` - highly recommended: sample size for the summary statistics, it is highly recommendation to provide.
    - `variant` - highly recommended: required if sumstat for different outcomes do not have the same number of variables (multiple sumstat and multiple LD).


- `LD` is a matrix of LD. This matrix does not need to contain the exact same variants as in `sumstat`, but the `colnames` and `rownames` of `LD` should include the `variant` names for proper alignment.

The input format for multiple traits is similar, but `sumstat` should be a list of data frames `sumstat = list(sumstat1, sumstat2, sumstat3)`. 
The flexibility of input format for multiple traits is as follows (see detailed usage with different input formats, 
refer to [Summary Statistics Colocalization](https://statfungen.github.io/colocboost/articles/Summary_Level_Colocalization.html).)::

- One LD matrix with a superset of variants in `sumstat` for all traits is allowed.
- Multiple LD matrices, each corresponding to a different trait, are also allowed for the trait-specific LD structure.
- Multiple LD matrices and unmatched `sumstat` data frames with a mapping dictionary are also allowed.  
