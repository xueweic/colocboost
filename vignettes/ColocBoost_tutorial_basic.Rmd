---
title: "ColocBoost Tutorial (Basic Usage)"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ColocBoost Tutorial (Basic Usage)}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This tutorial will guide you through using `ColocBoost` with individual-level data, summary statistics data, or the combination of individual-level data and summary statistics.


```{r setup}
library(colocboost)
```

## Individual-level data only

This tutorial demonstrates how to analyze individual-level data using `colocboost` package, specifically with the `Ind_5traits` dataset. Detailed information about the `Ind_5traits` dataset, which includes 5 simulated phenotypes alongside corresponding genotype matrices, is avaiable at `url`. The dataset is specifically designed to facilitate the identification of causal variants for complex traits.

**Loading and Analyzing Data**

To get started, load the `Ind_5traits` dataset into your R session. Once loaded, you can proceed with the analysis using the `colocboost` function. This function requires specifying genotypes `X` and phenotypes `Y` from the dataset:
```{r individual}
data("Ind_5traits")
res <- colocboost(X = Ind_5traits$X, Y = Ind_5traits$Y)
```
This command initiates the colocalization analysis, applying the ColocBoost methodology to identify potential genetic intersections between phenotypes and their respective genotypes.

**Results Exploration** 

After running the analysis, you can explore the results to identify colocalized variants and review the summary statistics. This output will provide insights into which variants are colocalized across the different phenotypes and offer a comprehensive overview of the statistical results from the colocalization analysis.

```{r indResults}
res$cos_details$cos$cos_index

res$cos_summary

```

## Summary statistics only

This tutorial demonstrates how to analyze summary statistics data using `colocboost` package, specifically with the `Sumstat_5traits` dataset. Detailed information about the `Sumstat_5traits` dataset, which includes the summary data for 5 simulated summary statistics and one LD matrix, where the summary data is directly caluculated using the marginal association from `Ind_5traits` data, is avaiable at `url`. This dataset is designed to facilitate the identification of causal variants for complex traits using summary statistics.


**Loading and Analyzing Data**
To get started, load the `Sumstat_5traits` dataset into your R session. Note: The `Sumstat_5traits` dataset includes only one LD matrix that applies to all traits. To demonstrate handling multiple traits, we replicate this single LD matrix for each trait as follows. To analyze the data using summary statistics, apply the colocboost function specifying the summary statistics and LD matrices.
```{r sumstat}
data("Sumstat_5traits")
data("Ind_5traits")
LD <- get_cormat(Ind_5traits$X[[1]])
res <- colocboost(sumstat = Sumstat_5traits$sumstat, LD = LD)
```
*Note*: This step duplicates the single LD matrix into a list of five matrices, one for each trait. This is to mimic scenarios where different traits might have different LD structures. ColocBoost allows for the input of a single LD matrix if the LD across traits is consistent. For more advanced usage involving different LD matrices or more complex setups, please refer to the advanced tutorial (URL).

**Results Exploration** (Consistent results obtained from individual-level)

After running the analysis, you can explore the results to identify colocalized variants and review the summary statistics. This output will provide insights into which variants are colocalized across the different phenotypes and offer a comprehensive overview of the statistical results from the colocalization analysis.

```{r sumstatResults}
res$cos_details$cos$cos_index

res$cos_summary
```
This section of the analysis provides insights into which variants are colocalized across the different phenotypes and offers a comprehensive overview of the statistical results from the colocalization analysis.



## Mixture usage of individual-level data and summary statistics

This tutorial provides a step-by-step guide on using both individual-level data and summary statistics within the `colocboost` package to perform multi-trait colocalization analysis. This approach is especially beneficial when comprehensive individual-level genotype and phenotype data is not available for all traits.

**Loading and Analyzing Datasets**

To get started, load both `Ind_5traits` and `Sumstat_5traits` datasets into your R session. Once loaded, we want to create a mixture usage datasets. For example, for traits 1,2,3, we use individual-level genotype and phenotype data; for traits 4 and 5, we use summary statistics and duplicated LD matrices.
```{r mixture}
data("Ind_5traits")
data("Sumstat_5traits")
X <- Ind_5traits$X[1:3]
Y <- Ind_5traits$Y[1:3]
sumstat <- Sumstat_5traits$sumstat[4:5]
LD <- get_cormat(Ind_5traits$X[[1]])
```
*Note*: This step duplicates the single LD matrix into a list of two matrices, one for each trait. This is to mimic scenarios where different traits might have different LD structures. ColocBoost allows for the input of a single LD matrix if the LD across traits is consistent. For more advanced usage involving different LD matrices or more complex setups, please refer to the advanced tutorial (URL).

Once loaded, you can proceed with the analysis using the `colocboost` function. This function requires specifying genotypes `X` and phenotypes `Y` from the individual-level dataset and summary statistics `sumstat` and LD matrices `LD` from summary dataset:
```{r mixRun}
res <- colocboost(X = X, Y = Y, sumstat = sumstat, LD = LD)
```

**Results Exploration** (Consistent results obtained from both individual-level only and summary statistics only)

After running the analysis, you can explore the results to identify colocalized variants and review the summary statistics. This output will provide insights into which variants are colocalized across the different phenotypes and offer a comprehensive overview of the statistical results from the colocalization analysis.
```{r mixResults}
res$cos_details$cos$cos_index

res$cos_summary
```
This section of the analysis provides insights into which variants are colocalized across the different phenotypes and offers a comprehensive overview of the statistical results from the colocalization analysis.


